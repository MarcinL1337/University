#include <avr/io.h>
#include <avr/pgmspace.h>
#include <time.h>
#include <util/delay.h>


#define LED_R PB2
#define LED_G PB1
#define LED_B PB3
#define LED_DDR DDRB
#define LED_PORT PORTB

const uint8_t hue_to_rgb[360][3] = { 
 {255, 0, 0},  {255, 4, 0},  {255, 8, 0},  {255, 13, 0},    {255, 17, 0}, 
 {255, 21, 0},  {255, 25, 0},  {255, 30, 0},  {255, 34, 0},    {255, 38, 0}, 
 {255, 42, 0},  {255, 47, 0},  {255, 51, 0},  {255, 55, 0},    {255, 60, 0}, 
 {255, 64, 0},  {255, 68, 0},  {255, 72, 0},  {255, 77, 0},    {255, 81, 0}, 
 {255, 85, 0},  {255, 89, 0},  {255, 94, 0},  {255, 98, 0},    {255, 102, 0}, 
 {255, 106, 0},  {255, 110, 0},  {255, 115, 0},  {255, 119, 0},    {255, 123, 0}, 
 {255, 128, 0},  {255, 132, 0},  {255, 136, 0},  {255, 140, 0},    {255, 144, 0}, 
 {255, 149, 0},  {255, 153, 0},  {255, 157, 0},  {255, 162, 0},    {255, 166, 0}, 
 {255, 170, 0},  {255, 174, 0},  {255, 178, 0},  {255, 183, 0},    {255, 187, 0}, 
 {255, 191, 0},  {255, 195, 0},  {255, 200, 0},  {255, 204, 0},    {255, 208, 0}, 
 {255, 212, 0},  {255, 217, 0},  {255, 221, 0},  {255, 225, 0},    {255, 229, 0}, 
 {255, 234, 0},  {255, 238, 0},  {255, 242, 0},  {255, 247, 0},    {255, 251, 0}, 
 {255, 255, 0},  {251, 255, 0},  {247, 255, 0},  {242, 255, 0},    {238, 255, 0}, 
 {234, 255, 0},  {230, 255, 0},  {225, 255, 0},  {221, 255, 0},    {217, 255, 0}, 
 {212, 255, 0},  {208, 255, 0},  {204, 255, 0},  {200, 255, 0},    {195, 255, 0}, 
 {191, 255, 0},  {187, 255, 0},  {183, 255, 0},  {178, 255, 0},    {174, 255, 0}, 
 {170, 255, 0},  {166, 255, 0},  {162, 255, 0},  {157, 255, 0},    {153, 255, 0}, 
 {149, 255, 0},  {144, 255, 0},  {140, 255, 0},  {136, 255, 0},    {132, 255, 0}, 
 {128, 255, 0},  {123, 255, 0},  {119, 255, 0},  {115, 255, 0},    {110, 255, 0}, 
 {106, 255, 0},  {102, 255, 0},  {98, 255, 0},  {94, 255, 0},    {89, 255, 0}, 
 {85, 255, 0},  {81, 255, 0},  {77, 255, 0},  {72, 255, 0},    {68, 255, 0}, 
 {64, 255, 0},  {60, 255, 0},  {55, 255, 0},  {51, 255, 0},    {47, 255, 0}, 
 {42, 255, 0},  {38, 255, 0},  {34, 255, 0},  {30, 255, 0},    {26, 255, 0}, 
 {21, 255, 0},  {17, 255, 0},  {13, 255, 0},  {8, 255, 0},    {4, 255, 0}, 
 {0, 255, 0},  {0, 255, 4},  {0, 255, 8},  {0, 255, 13},    {0, 255, 17}, 
 {0, 255, 21},  {0, 255, 25},  {0, 255, 30},  {0, 255, 34},    {0, 255, 38}, 
 {0, 255, 42},  {0, 255, 47},  {0, 255, 51},  {0, 255, 55},    {0, 255, 60}, 
 {0, 255, 64},  {0, 255, 68},  {0, 255, 72},  {0, 255, 77},    {0, 255, 81}, 
 {0, 255, 85},  {0, 255, 89},  {0, 255, 94},  {0, 255, 98},    {0, 255, 102}, 
 {0, 255, 106},  {0, 255, 111},  {0, 255, 115},  {0, 255, 119},    {0, 255, 123}, 
 {0, 255, 128},  {0, 255, 132},  {0, 255, 136},  {0, 255, 140},    {0, 255, 144}, 
 {0, 255, 149},  {0, 255, 153},  {0, 255, 157},  {0, 255, 162},    {0, 255, 166}, 
 {0, 255, 170},  {0, 255, 174},  {0, 255, 179},  {0, 255, 183},    {0, 255, 187}, 
 {0, 255, 191},  {0, 255, 195},  {0, 255, 200},  {0, 255, 204},    {0, 255, 208}, 
 {0, 255, 212},  {0, 255, 217},  {0, 255, 221},  {0, 255, 225},    {0, 255, 229}, 
 {0, 255, 234},  {0, 255, 238},  {0, 255, 242},  {0, 255, 247},    {0, 255, 251}, 
 {0, 255, 255},  {0, 251, 255},  {0, 247, 255},  {0, 242, 255},    {0, 238, 255}, 
 {0, 234, 255},  {0, 229, 255},  {0, 225, 255},  {0, 221, 255},    {0, 217, 255}, 
 {0, 212, 255},  {0, 208, 255},  {0, 204, 255},  {0, 200, 255},    {0, 195, 255}, 
 {0, 191, 255},  {0, 187, 255},  {0, 183, 255},  {0, 178, 255},    {0, 174, 255}, 
 {0, 170, 255},  {0, 166, 255},  {0, 162, 255},  {0, 157, 255},    {0, 153, 255}, 
 {0, 149, 255},  {0, 145, 255},  {0, 140, 255},  {0, 136, 255},    {0, 132, 255}, 
 {0, 128, 255},  {0, 123, 255},  {0, 119, 255},  {0, 115, 255},    {0, 111, 255}, 
 {0, 106, 255},  {0, 102, 255},  {0, 98, 255},  {0, 94, 255},    {0, 89, 255}, 
 {0, 85, 255},  {0, 81, 255},  {0, 76, 255},  {0, 72, 255},    {0, 68, 255}, 
 {0, 64, 255},  {0, 60, 255},  {0, 55, 255},  {0, 51, 255},    {0, 47, 255}, 
 {0, 43, 255},  {0, 38, 255},  {0, 34, 255},  {0, 30, 255},    {0, 25, 255}, 
 {0, 21, 255},  {0, 17, 255},  {0, 13, 255},  {0, 8, 255},    {0, 4, 255}, 
 {0, 0, 255},  {4, 0, 255},  {8, 0, 255},  {13, 0, 255},    {17, 0, 255}, 
 {21, 0, 255},  {25, 0, 255},  {30, 0, 255},  {34, 0, 255},    {38, 0, 255}, 
 {42, 0, 255},  {47, 0, 255},  {51, 0, 255},  {55, 0, 255},    {60, 0, 255}, 
 {64, 0, 255},  {68, 0, 255},  {72, 0, 255},  {76, 0, 255},    {81, 0, 255}, 
 {85, 0, 255},  {89, 0, 255},  {93, 0, 255},  {98, 0, 255},    {102, 0, 255}, 
 {106, 0, 255},  {111, 0, 255},  {115, 0, 255},  {119, 0, 255},    {123, 0, 255}, 
 {128, 0, 255},  {132, 0, 255},  {136, 0, 255},  {140, 0, 255},    {144, 0, 255}, 
 {149, 0, 255},  {153, 0, 255},  {157, 0, 255},  {162, 0, 255},    {166, 0, 255}, 
 {170, 0, 255},  {174, 0, 255},  {179, 0, 255},  {183, 0, 255},    {187, 0, 255}, 
 {191, 0, 255},  {195, 0, 255},  {200, 0, 255},  {204, 0, 255},    {208, 0, 255}, 
 {213, 0, 255},  {217, 0, 255},  {221, 0, 255},  {225, 0, 255},    {230, 0, 255}, 
 {234, 0, 255},  {238, 0, 255},  {242, 0, 255},  {247, 0, 255},    {251, 0, 255}, 
 {255, 0, 255},  {255, 0, 251},  {255, 0, 247},  {255, 0, 242},    {255, 0, 238}, 
 {255, 0, 234},  {255, 0, 230},  {255, 0, 225},  {255, 0, 221},    {255, 0, 217}, 
 {255, 0, 212},  {255, 0, 208},  {255, 0, 204},  {255, 0, 200},    {255, 0, 195}, 
 {255, 0, 191},  {255, 0, 187},  {255, 0, 183},  {255, 0, 179},    {255, 0, 174}, 
 {255, 0, 170},  {255, 0, 166},  {255, 0, 161},  {255, 0, 157},    {255, 0, 153}, 
 {255, 0, 149},  {255, 0, 144},  {255, 0, 140},  {255, 0, 136},    {255, 0, 132}, 
 {255, 0, 128},  {255, 0, 123},  {255, 0, 119},  {255, 0, 115},    {255, 0, 111}, 
 {255, 0, 106},  {255, 0, 102},  {255, 0, 98},  {255, 0, 94},    {255, 0, 89}, 
 {255, 0, 85},  {255, 0, 81},  {255, 0, 77},  {255, 0, 72},    {255, 0, 68}, 
 {255, 0, 64},  {255, 0, 60},  {255, 0, 55},  {255, 0, 51},    {255, 0, 47}, 
 {255, 0, 43},  {255, 0, 38},  {255, 0, 34},  {255, 0, 30},    {255, 0, 26}, 
 {255, 0, 21},  {255, 0, 17},  {255, 0, 13},  {255, 0, 8},    {255, 0, 4}
};

const int16_t tab[] PROGMEM = {
  10000, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9998, 9998, 9998, 9998, 9997, 9997, 9997, 9996, 9996, 9996, 9995, 9995, 9994, 9994, 9993, 9993, 9992, 9992, 9991, 9991, 9990, 9989, 9989, 9988, 9987, 9987, 9986, 9985, 9984, 9984, 9983, 9982, 9981, 9980, 9979, 9978, 9977, 9976, 9976, 9975, 9974, 9972, 9971, 9970, 9969, 9968, 9967, 9966, 9965, 9964, 9962, 9961, 9960, 9959, 9957, 9956, 9955, 9953, 9952, 9951, 9949, 9948, 9946, 9945, 9943, 9942, 9940, 9939, 9937, 9936, 9934, 9932, 9931, 9929, 9927, 9926, 9924, 9922, 9920, 9919, 9917, 9915, 9913, 9911, 9910, 9908, 9906, 9904, 9902, 9900, 9898, 9896, 9894, 9892, 9890, 9888, 9885, 9883, 9881, 9879, 9877, 9875, 9872, 9870, 9868, 9866, 9863, 9861, 9859, 9856, 9854, 9851, 9849, 9847, 9844, 9842, 9839, 9837, 9834, 9831, 9829, 9826, 9824, 9821, 9818, 9816, 9813, 9810, 9808, 9805, 9802, 9799, 9796, 9794, 9791, 9788, 9785, 9782, 9779, 9776, 9773, 9770, 9767, 9764, 9761, 9758, 9755, 9752, 9749, 9746, 9743, 9739, 9736, 9733, 9730, 9726, 9723, 9720, 9717, 9713, 9710, 9707, 9703, 9700, 9696, 9693, 9689, 9686, 9682, 9679, 9675, 9672, 9668, 9665, 9661, 9658, 9654, 9650, 9647, 9643, 9639, 9635, 9632, 9628, 9624, 9620, 9616, 9613, 9609, 9605, 9601, 9597, 9593, 9589, 9585, 9581, 9577, 9573, 9569, 9565, 9561, 9557, 9553, 9548, 9544, 9540, 9536, 9532, 9528, 9523, 9519, 9515, 9510, 9506, 9502, 9497, 9493, 9489, 9484, 9480, 9475, 9471, 9466, 9462, 9457, 9453, 9448, 9444, 9439, 9434, 9430, 9425, 9421, 9416, 9411, 9406, 9402, 9397, 9392, 9387, 9383, 9378, 9373, 9368, 9363, 9358, 9353, 9348, 9344, 9339, 9334, 9329, 9324, 9319, 9314, 9308, 9303, 9298, 9293, 9288, 9283, 9278, 9273, 9267, 9262, 9257, 9252, 9246, 9241, 9236, 9230, 9225, 9220, 9214, 9209, 9204, 9198, 9193, 9187, 9182, 9176, 9171, 9165, 9160, 9154, 9149, 9143, 9137, 9132, 9126, 9121, 9115, 9109, 9103, 9098, 9092, 9086, 9080, 9075, 9069, 9063, 9057, 9051, 9046, 9040, 9034, 9028, 9022, 9016, 9010, 9004, 8998, 8992, 8986, 8980, 8974, 8968, 8962, 8956, 8949, 8943, 8937, 8931, 8925, 8919, 8912, 8906, 8900, 8894, 8887, 8881, 8875, 8868, 8862, 8856, 8849, 8843, 8837, 8830, 8824, 8817, 8811, 8804, 8798, 8791, 8785, 8778, 8772, 8765, 8759, 8752, 8745, 8739, 8732, 8725, 8719, 8712, 8705, 8699, 8692, 8685, 8678, 8672, 8665, 8658, 8651, 8644, 8637, 8631, 8624, 8617, 8610, 8603, 8596, 8589, 8582, 8575, 8568, 8561, 8554, 8547, 8540, 8533, 8526, 8519, 8512, 8504, 8497, 8490, 8483, 8476, 8469, 8461, 8454, 8447, 8440, 8432, 8425, 8418, 8411, 8403, 8396, 8389, 8381, 8374, 8366, 8359, 8352, 8344, 8337, 8329, 8322, 8314, 8307, 8299, 8292, 8284, 8277, 8269, 8262, 8254, 8247, 8239, 8231, 8224, 8216, 8208, 8201, 8193, 8185, 8178, 8170, 8162, 8154, 8147, 8139, 8131, 8123, 8115, 8108, 8100, 8092, 8084, 8076, 8068, 8060, 8052, 8044, 8037, 8029, 8021, 8013, 8005, 7997, 7989, 7981, 7973, 7965, 7957, 7948, 7940, 7932, 7924, 7916, 7908, 7900, 7892, 7883, 7875, 7867, 7859, 7851, 7842, 7834, 7826, 7818, 7809, 7801, 7793, 7785, 7776, 7768, 7760, 7751, 7743, 7735, 7726, 7718, 7709, 7701, 7693, 7684, 7676, 7667, 7659, 7650, 7642, 7633, 7625, 7616, 7608, 7599, 7591, 7582, 7574, 7565, 7556, 7548, 7539, 7531, 7522, 7513, 7505, 7496, 7487, 7479, 7470, 7461, 7453, 7444, 7435, 7426, 7418, 7409, 7400, 7391, 7383, 7374, 7365, 7356, 7347, 7338, 7330, 7321, 7312, 7303, 7294, 7285, 7276, 7267, 7259, 7250, 7241, 7232, 7223, 7214, 7205, 7196, 7187, 7178, 7169, 7160, 7151, 7142, 7133, 7124, 7115, 7106, 7097, 7087, 7078, 7069, 7060, 7051, 7042, 7033, 7024, 7015, 7005, 6996, 6987, 6978, 6969, 6959, 6950, 6941, 6932, 6923, 6913, 6904, 6895, 6886, 6876, 6867, 6858, 6849, 6839, 6830, 6821, 6811, 6802, 6793, 6783, 6774, 6765, 6755, 6746, 6736, 6727, 6718, 6708, 6699, 6690, 6680, 6671, 6661, 6652, 6642, 6633, 6623, 6614, 6605, 6595, 6586, 6576, 6567, 6557, 6548, 6538, 6529, 6519, 6510, 6500, 6490, 6481, 6471, 6462, 6452, 6443, 6433, 6423, 6414, 6404, 6395, 6385, 6375, 6366, 6356, 6347, 6337, 6327, 6318, 6308, 6298, 6289, 6279, 6269, 6260, 6250, 6240, 6231, 6221, 6211, 6202, 6192, 6182, 6172, 6163, 6153, 6143, 6134, 6124, 6114, 6104, 6095, 6085, 6075, 6065, 6055, 6046, 6036, 6026, 6016, 6007, 5997, 5987, 5977, 5967, 5958, 5948, 5938, 5928, 5918, 5908, 5899, 5889, 5879, 5869, 5859, 5849, 5839, 5830, 5820, 5810, 5800, 5790, 5780, 5770, 5761, 5751, 5741, 5731, 5721, 5711, 5701, 5691, 5681, 5671, 5662, 5652, 5642, 5632, 5622, 5612, 5602, 5592, 5582, 5572, 5562, 5552, 5542, 5532, 5523, 5513, 5503, 5493, 5483, 5473, 5463, 5453, 5443, 5433, 5423, 5413, 5403, 5393, 5383, 5373, 5363, 5353, 5343, 5333, 5323, 5313, 5303, 5293, 5283, 5273, 5263, 5253, 5243, 5233, 5223, 5213, 5203, 5193, 5183, 5173, 5163, 5153, 5143, 5133, 5123, 5113, 5103, 5093, 5083, 5073, 5063, 5053, 5043, 5033, 5023, 5013, 5003, 4987, 4967, 4947, 4927, 4907, 4887, 4867, 4847, 4827, 4808, 4788, 4768, 4748, 4728, 4708, 4688, 4668, 4648, 4628, 4608, 4588, 4568, 4548, 4528, 4508, 4488, 4468, 4449, 4429, 4409, 4389, 4369, 4349, 4329, 4310, 4290, 4270, 4250, 4231, 4211, 4191, 4171, 4152, 4132, 4112, 4093, 4073, 4053, 4034, 4014, 3994, 3975, 3955, 3936, 3916, 3897, 3877, 3858, 3838, 3819, 3799, 3780, 3761, 3741, 3722, 3702, 3683, 3664, 3645, 3625, 3606, 3587, 3568, 3549, 3530, 3510, 3491, 3472, 3453, 3434, 3415, 3396, 3377, 3358, 3340, 3321, 3302, 3283, 3264, 3246, 3227, 3208, 3190, 3171, 3152, 3134, 3115, 3097, 3078, 3060, 3041, 3023, 3005, 2986, 2968, 2950, 2931, 2913, 2895, 2877, 2859, 2841, 2823, 2805, 2787, 2769, 2751, 2733, 2715, 2698, 2680, 2662, 2645, 2627, 2609, 2592, 2574, 2557, 2539, 2522, 2505, 2487, 2470, 2453, 2436, 2419, 2401, 2384, 2367, 2350, 2333, 2316, 2300, 2283, 2266, 2249, 2233, 2216, 2199, 2183, 2166, 2150, 2133, 2117, 2101, 2085, 2068, 2052, 2036, 2020, 2004, 1988, 1972, 1956, 1940, 1924, 1909, 1893, 1877, 1862, 1846, 1831, 1815, 1800, 1785, 1769, 1754, 1739, 1724, 1709, 1694, 1679, 1664, 1649, 1634, 1619, 1604, 1590, 1575, 1561, 1546, 1532, 1517, 1503, 1489, 1475, 1460, 1446, 1432, 1418, 1404, 1390, 1377, 1363, 1349, 1336, 1322, 1308, 1295, 1282, 1268, 1255, 1242, 1229, 1215, 1202, 1189, 1177, 1164, 1151, 1138, 1125, 1113, 1100, 1088, 1075, 1063, 1051, 1038, 1026, 1014, 1002, 990, 978, 966, 955, 943, 931, 920, 908, 897, 885, 874, 863, 851, 840, 829, 818, 807, 796, 786, 775, 764, 754, 743, 733, 722, 712, 702, 692, 681, 671, 661, 651, 642, 632, 622, 613, 603, 593, 584, 575, 565, 556, 547, 538, 529, 520, 511, 502, 494, 485, 477, 468, 460, 451, 443, 435, 427, 419, 411, 403, 395, 387, 380, 372, 364, 357, 350, 342, 335, 328, 321, 314, 307, 300, 293, 286, 280, 273, 267, 260, 254, 248, 241, 235, 229, 223, 218, 212, 206, 200, 195, 189, 184, 179, 173, 168, 163, 158, 153, 148, 143, 139, 134, 129, 125, 120, 116, 112, 108, 104, 100, 96, 92, 88, 84, 81, 77, 74, 70, 67, 64, 61, 57, 54, 52, 49, 46, 43, 41, 38, 36, 33, 31, 29, 27, 25, 23, 21, 19, 17, 16, 14, 13, 11, 10, 9, 7, 6, 5, 4, 4, 3, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 3, 3, 4, 5, 6, 7, 8, 10, 11, 12, 14, 15, 17, 19, 20, 22, 24, 26, 28, 31, 33, 35, 38, 40, 43, 45, 48, 51, 54, 57, 60, 63, 66, 70, 73, 76, 80, 84, 87, 91, 95, 99, 103, 107, 111, 115, 120, 124, 128, 133, 138, 142, 147, 152, 157, 162, 167, 172, 177, 183, 188, 194, 199, 205, 211, 216, 222, 228, 234, 240, 246, 253, 259, 265, 272, 278, 285, 292, 299, 305, 312, 319, 326, 334, 341, 348, 355, 363, 370, 378, 386, 393, 401, 409, 417, 425, 433, 441, 450, 458, 466, 475, 483, 492, 501, 510, 518, 527, 536, 545, 554, 564, 573, 582, 592, 601, 611, 620, 630, 640, 650, 659, 669, 679, 690, 700, 710, 720, 731, 741, 752, 762, 773, 784, 794, 805, 816, 827, 838, 849, 860, 872, 883, 894, 906, 917, 929, 941, 952, 964, 976, 988, 1000, 1012, 1024, 1036, 1048, 1061, 1073, 1085, 1098, 1110, 1123, 1136, 1148, 1161, 1174, 1187, 1200, 1213, 1226, 1239, 1252, 1266, 1279, 1292, 1306, 1319, 1333, 1347, 1360, 1374, 1388, 1402, 1416, 1430, 1444, 1458, 1472, 1486, 1500, 1515, 1529, 1543, 1558, 1572, 1587, 1602, 1616, 1631, 1646, 1661, 1676, 1691, 1706, 1721, 1736, 1751, 1766, 1782, 1797, 1812, 1828, 1843, 1859, 1874, 1890, 1906, 1921, 1937, 1953, 1969, 1985, 2001, 2017, 2033, 2049, 2065, 2081, 2098, 2114, 2130, 2147, 2163, 2180, 2196, 2213, 2229, 2246, 2263, 2280, 2296, 2313, 2330, 2347, 2364, 2381, 2398, 2415, 2432, 2449, 2467, 2484, 2501, 2519, 2536, 2553, 2571, 2588, 2606, 2624, 2641, 2659, 2676, 2694, 2712, 2730, 2748, 2765, 2783, 2801, 2819, 2837, 2855, 2873, 2892, 2910, 2928, 2946, 2964, 2983, 3001, 3019, 3038, 3056, 3075, 3093, 3112, 3130, 3149, 3167, 3186, 3205, 3223, 3242, 3261, 3279, 3298, 3317, 3336, 3355, 3374, 3393, 3412, 3431, 3450, 3469, 3488, 3507, 3526, 3545, 3564, 3583, 3602, 3622, 3641, 3660, 3679, 3699, 3718, 3737, 3757, 3776, 3796, 3815, 3834, 3854, 3873, 3893, 3912, 3932, 3951, 3971, 3991, 4010, 4030, 4049, 4069, 4089, 4108, 4128, 4148, 4167, 4187, 4207, 4227, 4246, 4266, 4286, 4306, 4326, 4345, 4365, 4385, 4405, 4425, 4445, 4465, 4484, 4504, 4524, 4544, 4564, 4584, 4604, 4624, 4644, 4664, 4684, 4704, 4724, 4744, 4764, 4784, 4804, 4824, 4844, 4864, 4884, 4904, 4924, 4944, 4964, 4984, 5002, 5012, 5022, 5032, 5042, 5052, 5062, 5072, 5082, 5092, 5102, 5112, 5122, 5132, 5142, 5152, 5162, 5172, 5181, 5191, 5201, 5211, 5221, 5231, 5241, 5251, 5261, 5271, 5281, 5291, 5301, 5311, 5321, 5331, 5341, 5351, 5361, 5371, 5381, 5391, 5401, 5411, 5421, 5431, 5441, 5451, 5461, 5471, 5481, 5491, 5501, 5511, 5521, 5531, 5540, 5550, 5560, 5570, 5580, 5590, 5600, 5610, 5620, 5630, 5640, 5650, 5660, 5670, 5679, 5689, 5699, 5709, 5719, 5729, 5739, 5749, 5759, 5768, 5778, 5788, 5798, 5808, 5818, 5828, 5838, 5847, 5857, 5867, 5877, 5887, 5897, 5906, 5916, 5926, 5936, 5946, 5956, 5965, 5975, 5985, 5995, 6005, 6014, 6024, 6034, 6044, 6054, 6063, 6073, 6083, 6093, 6102, 6112, 6122, 6132, 6141, 6151, 6161, 6171, 6180, 6190, 6200, 6209, 6219, 6229, 6238, 6248, 6258, 6268, 6277, 6287, 6297, 6306, 6316, 6325, 6335, 6345, 6354, 6364, 6374, 6383, 6393, 6402, 6412, 6422, 6431, 6441, 6450, 6460, 6469, 6479, 6489, 6498, 6508, 6517, 6527, 6536, 6546, 6555, 6565, 6574, 6584, 6593, 6603, 6612, 6622, 6631, 6641, 6650, 6659, 6669,
  6678, 6688, 6697, 6707, 6716, 6725, 6735, 6744, 6753, 6763, 6772, 6781, 6791, 6800, 6809, 6819, 6828, 6837, 6847, 6856, 6865, 6875, 6884, 6893, 6902, 6912, 6921, 6930, 6939, 6948, 6958, 6967, 6976, 6985, 6994, 7004, 7013, 7022, 7031, 7040, 7049, 7058, 7068, 7077, 7086, 7095, 7104, 7113, 7122, 7131, 7140, 7149, 7158, 7167, 7176, 7185, 7194, 7203, 7212, 7221, 7230, 7239, 7248, 7257, 7266, 7275, 7284, 7292, 7301, 7310, 7319, 7328, 7337, 7346, 7354, 7363, 7372, 7381, 7390, 7398, 7407, 7416, 7425, 7433, 7442, 7451, 7460, 7468, 7477, 7486, 7494, 7503, 7512, 7520, 7529, 7538, 7546, 7555, 7563, 7572, 7580, 7589, 7598, 7606, 7615, 7623, 7632, 7640, 7649, 7657, 7666, 7674, 7683, 7691, 7699, 7708, 7716, 7725, 7733, 7741, 7750, 7758, 7766, 7775, 7783, 7791, 7800, 7808, 7816, 7824, 7833, 7841, 7849, 7857, 7866, 7874, 7882, 7890, 7898, 7906, 7914, 7923, 7931, 7939, 7947, 7955, 7963, 7971, 7979, 7987, 7995, 8003, 8011, 8019, 8027, 8035, 8043, 8051, 8059, 8067, 8075, 8082, 8090, 8098, 8106, 8114, 8122, 8129, 8137, 8145, 8153, 8161, 8168, 8176, 8184, 8191, 8199, 8207, 8214, 8222, 8230, 8237, 8245, 8253, 8260, 8268, 8275, 8283, 8290, 8298, 8305, 8313, 8320, 8328, 8335, 8343, 8350, 8358, 8365, 8372, 8380, 8387, 8395, 8402, 8409, 8416, 8424, 8431, 8438, 8446, 8453, 8460, 8467, 8474, 8482, 8489, 8496, 8503, 8510, 8517, 8524, 8532, 8539, 8546, 8553, 8560, 8567, 8574, 8581, 8588, 8595, 8602, 8609, 8615, 8622, 8629, 8636, 8643, 8650, 8657, 8663, 8670, 8677, 8684, 8691, 8697, 8704, 8711, 8717, 8724, 8731, 8737, 8744, 8751, 8757, 8764, 8770, 8777, 8784, 8790, 8797, 8803, 8810, 8816, 8822, 8829, 8835, 8842, 8848, 8854, 8861, 8867, 8874, 8880, 8886, 8892, 8899, 8905, 8911, 8917, 8924, 8930, 8936, 8942, 8948, 8954, 8961, 8967, 8973, 8979, 8985, 8991, 8997, 9003, 9009, 9015, 9021, 9027, 9033, 9038, 9044, 9050, 9056, 9062, 9068, 9074, 9079, 9085, 9091, 9097, 9102, 9108, 9114, 9119, 9125, 9131, 9136, 9142, 9148, 9153, 9159, 9164, 9170, 9175, 9181, 9186, 9192, 9197, 9203, 9208, 9213, 9219, 9224, 9229, 9235, 9240, 9245, 9251, 9256, 9261, 9266, 9272, 9277, 9282, 9287, 9292, 9297, 9302, 9307, 9313, 9318, 9323, 9328, 9333, 9338, 9343, 9348, 9352, 9357, 9362, 9367, 9372, 9377, 9382, 9386, 9391, 9396, 9401, 9406, 9410, 9415, 9420, 9424, 9429, 9434, 9438, 9443, 9447, 9452, 9456, 9461, 9465, 9470, 9474, 9479, 9483, 9488, 9492, 9497, 9501, 9505, 9510, 9514, 9518, 9522, 9527, 9531, 9535, 9539, 9544, 9548, 9552, 9556, 9560, 9564, 9568, 9572, 9576, 9580, 9584, 9588, 9592, 9596, 9600, 9604, 9608, 9612, 9616, 9619, 9623, 9627, 9631, 9635, 9638, 9642, 9646, 9649, 9653, 9657, 9660, 9664, 9668, 9671, 9675, 9678, 9682, 9685, 9689, 9692, 9696, 9699, 9703, 9706, 9709, 9713, 9716, 9719, 9723, 9726, 9729, 9732, 9736, 9739, 9742, 9745, 9748, 9751, 9754, 9758, 9761, 9764, 9767, 9770, 9773, 9776, 9779, 9781, 9784, 9787, 9790, 9793, 9796, 9799, 9801, 9804, 9807, 9810, 9812, 9815, 9818, 9820, 9823, 9826, 9828, 9831, 9834, 9836, 9839, 9841, 9844, 9846, 9848, 9851, 9853, 9856, 9858, 9860, 9863, 9865, 9867, 9870, 9872, 9874, 9876, 9879, 9881, 9883, 9885, 9887, 9889, 9891, 9893, 9895, 9897, 9899, 9901, 9903, 9905, 9907, 9909, 9911, 9913, 9915, 9917, 9918, 9920, 9922, 9924, 9925, 9927, 9929, 9930, 9932, 9934, 9935, 9937, 9938, 9940, 9942, 9943, 9945, 9946, 9947, 9949, 9950, 9952, 9953, 9954, 9956, 9957, 9958, 9960, 9961, 9962, 9963, 9965, 9966, 9967, 9968, 9969, 9970, 9971, 9972, 9973, 9974, 9975, 9976, 9977, 9978, 9979, 9980, 9981, 9982, 9983, 9983, 9984, 9985, 9986, 9986, 9987, 9988, 9988, 9989, 9990, 9990, 9991, 9992, 9992, 9993, 9993, 9994, 9994, 9995, 9995, 9995, 9996, 9996, 9997, 9997, 9997, 9997, 9998, 9998, 9998, 9998, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999, 9999
};

void timer1_init()
{
  // ustaw tryb licznika
  // COM1A = 10   -- non-inverting mode
  // WGM1  = 1110 -- fast PWM top=ICR1
  // CS1   = 101  -- prescaler 1024
  // ICR1  = 15624
  // częstotliwość 16e6/(1024*(1+15624)) = 1 Hz
  // wzór: datasheet 20.12.3 str. 164
  ICR1 = 2000;
  TCCR1A = (1 << WGM10) | (1 << COM1B1) | (1 << COM1A1);
  TCCR1B = _BV(WGM12)| _BV(CS11) | _BV(CS10);
  // ustaw pin OC1A (PB1) jako wyjście
  LED_DDR |= _BV(LED_G);
  LED_DDR |= _BV(LED_R);
  // LED_DDR |= _BV(LED_B);
}

int main()
{
  // uruchom licznik
  timer1_init();
  // ustaw wypełnienie 50%
  OCR1A = tab[0];
  while(1){
    int16_t H = rand() % 360;
    int16_t tab_val = pgm_read_word(&tab[0]);
    OCR1A = hue_to_rgb[H][1] * tab_val / 25.5;
    OCR1B = hue_to_rgb[H][0] * tab_val / 25.5;
    for(int i = 0; i < sizeof(tab) / sizeof(tab[0]); i++){
        while(TCNT1 != 0);
        tab_val = pgm_read_word(&tab[i]);
      // _delay_ms(10);
    }
  }
}