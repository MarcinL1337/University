import matplotlib.pyplot as plt

def nspline(x, y):
    h = [x[i] - x[i - 1] for i in range(1, len(x))]
    h.insert(0, 0)
    lamb = [h[i] / (h[i] + h[i + 1]) for i in range(1, len(x) - 1)]
    lamb.insert(0, 0)
    d = [6*(((y[i + 1] - y[i]) / (x[i + 1] - x[i]))
            -
            ((y[i] - y[i - 1]) / (x[i] - x[i - 1])))
            /
            (x[i + 1] - x[i - 1]) for i in range(1, len(x) - 1)]
    d.insert(0, 0)
    p = [0]
    q = [0]
    for i in range(1, len(x) - 1):
        v = lamb[i] * p[i - 1] + 2
        p.append((lamb[i] - 1) / v)
        q.append((d[i] - lamb[i] * q[i - 1]) / v)
    M = [0, q[len(q) - 1], 0]
    p.pop()

    for i in range(len(x) - 3, 0, -1):
        M.insert(1, p[i] * M[1] + q[i])

    def fun(a, k):
        return (1 / h[k+1]) * ((1 / 6) * M[k] * pow((x[k + 1] - a), 3)
                           + (1 / 6) * M[k + 1] * pow((a - xs[k]), 3)
                           + (y[k] - (1 / 6) * M[k] * h[k+1] ** 2) * (xs[k + 1] - a)
                           + (y[k + 1] - (1 / 6) * M[k + 1] * h[k+1] ** 2) * (a - xs[k]))
    return fun


x_tab = [5.5, 8.5, 10.5, 13, 17, 20.5, 24.5, 28, 32.5, 37.5, 40.5, 42.5, 45, 47,
     49.5, 50.5, 51, 51.5, 52.5, 53, 52.8, 52, 51.5, 53, 54, 55, 56, 55.5, 54.5, 54, 55, 57, 58.5,
     59, 61.5, 62.5, 63.5, 63, 61.5, 59, 55, 53.5, 52.5, 50.5, 49.5, 50, 51, 50.5, 49, 47.5, 46,
     45.5, 45.5, 45.5, 46, 47.5, 47.5, 46, 43, 41, 41.5, 41.5, 41, 39.5, 37.5, 34.5, 31.5, 28, 24,
     21, 18.5, 17.5, 16.5, 15, 13, 10, 8, 6, 6, 6, 5.5, 3.5, 1, 0, 0, 0.5, 1.5, 3.5, 5, 5, 4.5, 4.5, 5.5,
     6.5, 6.5, 5.5]
y_tab = [41, 40.5, 40, 40.5, 41.5, 41.5, 42, 42.5, 43.5, 45, 47, 49.5, 53, 57, 59,
     59.5, 61.5, 63, 64, 64.5, 63, 61.5, 60.5, 61, 62, 63, 62.5, 61.5, 60.5, 60, 59.5, 59, 58.5,
     57.5, 55.5, 54, 53, 51.5, 50, 50, 50.5, 51, 50.5, 47.5, 44, 40.5, 36, 30.5, 28, 25.5, 21.5,
     18, 14.5, 10.5, 7.50, 4, 2.50, 1.50, 2, 3.50, 7, 12.5, 17.5, 22.5, 25, 25, 25, 25.5, 26.5,
     27.5, 27.5, 26.5, 23.5, 21, 19, 17, 14.5, 11.5, 8, 4, 1, 0, 0.5, 3, 6.50, 10, 13, 16.5, 20.5,
     25.5, 29, 33, 35, 36.5, 39, 41]

sx = nspline([k/95 for k in range(0, 96)], x_tab)
sy = nspline([k/95 for k in range(0, 96)], y_tab)
M = 30
zakres = 2000
xs = [k/95 for k in range(0, 96)]
k = 1
x = []
y = []
for i in range(zakres+1):
    j = i/zakres
    if k < 95 and j > xs[k]: k += 1
    x.append(sx(j, k-1))
    y.append(sy(j, k-1))
plt.scatter(x, y, c="blue")

plt.show()
